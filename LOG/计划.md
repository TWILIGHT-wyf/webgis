# Vue 3 + TypeScript WebGIS 项目计划（含 UniApp 加分项）

目标
- 在 4 周内产出一套“可上线展示”的 WebGIS 管理系统（主线）与一个轻量 UniApp/小程序巡检端（副线加分），对齐南京主流前端岗位（政企/园区/物联/可视化）。
- 形成在线 Demo、Docker 镜像、CI/CD、测试覆盖与演示视频，便于面试展示与投递。

岗位匹配亮点
- Web 前端（南京主线）：Vue3/TS、地图可视化（Leaflet/Mapbox）、ECharts 报表、权限与路由守卫、工程化（CI/CD、Docker、Sentry、PWA）。
- 小程序/移动（加分）：UniApp 巡检端（登录、定位、拍照上传、离线队列、重传）。

项目组合与仓库策略
- 主项目：webgis-admin（Vue3 + Vite + TS + Pinia + Leaflet + ECharts + MSW + Vitest + Playwright）
- 副项目（可一周完成）：webgis-inspect-uni（UniApp 多端：H5/微信小程序/Android）
- 仓库建议：两个独立仓库，主仓库为投递主力；副仓库链接到主仓库 README 的“移动端加分项”。

核心功能范围（主线 Web）
- 登录/鉴权：RBAC（角色/菜单/按钮级）、路由守卫、持久化与刷新策略说明
- 地图仪表盘：OSM 底图、设施点位、聚合、圈选（Leaflet.draw + Turf），地图/列表联动
- 设施管理：列表/详情/创建编辑（地图选点），上传附件，表单校验（yup/zod）
- 可视化：ECharts 统计（状态占比、区域分布、时间趋势）与地图联动
- 实时：socket.io（状态变更/告警提示）
- 工程化：严格 TS、E2E/单元测试、Sentry、PWA（瓦片/接口缓存）、Docker、GitHub Actions

副线（加分）功能范围（UniApp）
- 登录、工单列表、地图选点（定位）、拍照上传、离线队列与恢复重传
- H5 + 微信小程序优先，真机演示视频与二维码

技术选型（已对齐企业常用）
- Vue 3（script setup/Composition API）、Vite、TypeScript（strict）
- 状态与数据：Pinia、Axios、@tanstack/vue-query（缓存/重试/离线）
- 地图：Leaflet 5.x、Leaflet.markercluster、Leaflet.draw、Turf.js
- 可视化：ECharts
- Mock/测试：MSW v2、Vitest、Vue Test Utils、Playwright
- 工程与部署：ESLint+Prettier、Husky、commitlint、GitHub Actions、Docker + Nginx、Sentry、vite-plugin-pwa

4 周里程碑与验收标准

Week 1｜工程基线 + 鉴权 + 地图起步
- 交付
  - 严格 TS、ESLint/Prettier、commitlint/Husky、路径别名、路由骨架、AppShell
  - MSW v2 初始化（http + HttpResponse，msw/browser），登录/当前用户 mock
  - 登录页 + 路由守卫（meta.requiresAuth）、Pinia 鉴权 store（localStorage 恢复）
  - MapView 基础（OSM、比例尺/缩放、窗口自适应、marker 图标修复）
- 验收
  - 未登录拦截至 /login，登录后达 /dashboard，刷新保持登录
  - 地图正常渲染，控制台 0 error；typecheck/lint 全绿

Week 2｜设施模块 + 地图联动 + 圈选与统计
- 交付
  - 设施模型（GeoJSON Point + 属性）与分页接口（MSW）
  - 列表/详情页，创建/编辑（地图选点），表单校验（yup/zod）
  - 地图与列表双向联动（定位/高亮/Popup）
  - Leaflet.draw + Turf 圈选过滤；ECharts 仪表盘（状态占比/区域分布）
- 验收
  - 圈选后列表/图表联动；URL 同步选中 ID；回退命中缓存快速渲染
  - 表单校验可用，创建/编辑后列表自动刷新

Week 3｜性能与稳定性 + PWA + 国际化
- 交付
  - 聚合（markercluster）、虚拟滚动（大列表可选）
  - Sentry 接入、统一错误模型与错误边界
  - PWA（瓦片与接口缓存策略、更新提示）
  - i18n（中英）、基础 a11y 检查
- 验收
  - 5k 点位交互流畅（FPS 55+），主包 < 300KB gzip（示例）
  - 断网可访问核心页面；Sentry 可定位源码行

Week 4｜测试 + CI/CD + Docker + Demo 与文档
- 交付
  - Vitest 单元/组件、Playwright E2E（登录→筛选→圈选→联动）
  - GitHub Actions：lint/type/test/build；构建 Docker 镜像工件
  - Dockerfile（多阶段）+ Nginx（Gzip/Brotli/缓存头）
  - 在线 Demo（Vercel/自服）与 1–2 分钟演示视频；完善 README（功能/架构图/运行/部署/截图）
- 验收
  - CI 全绿；一条命令本地/服务器启动容器；E2E 通过
  - README 可直接跟跑；演示视频顺畅

1 周加分项（可与 Week 3/4 并行 2–3 天）：UniApp 巡检端
- 交付
  - 端到端：登录、列表、定位选点、拍照上传（压缩）、离线队列/重传
  - H5 + 微信小程序；真机演示视频/二维码
- 验收
  - 弱网/断网可新增队列，恢复后自动上传；UI 与后台权限一致

任务拆分（Issue 模板示例）
- feat(auth): Pinia 鉴权 + 路由守卫 + 恢复流程
- feat(map): MapView + OSM + controls + 自适应
- feat(msw): v2 handlers（/api/auth, /api/facilities）
- feat(facilities): 列表/详情/创建编辑 + 表单校验
- feat(map-linkage): 列表/地图联动 + Popup
- feat(spatial-filter): draw + turf 圈选过滤
- feat(charts): ECharts 仪表盘与筛选联动
- feat(cluster): markercluster 与性能优化
- feat(pwa): PWA 缓存策略 + 更新提示
- feat(obs): Sentry + 错误边界
- test(unit): Vitest 单测覆盖 stores/services/components
- test(e2e): Playwright 覆盖关键流程
- ci: GitHub Actions（lint/type/test/build/docker）
- ops: Dockerfile + Nginx 配置 + 部署脚本
- docs: README/架构图/演示脚本与视频

关键验收指标（用于 README 与面试）
- 性能：首屏 LCP < 2.5s；地图交互 FPS ≥ 55；主包 < 300KB gzip
- 质量：typecheck 0 错；ESLint 0 错；单元/组件覆盖 ≥ 80%；E2E 通过
- 工程化：CI 全链路；Docker 镜像可复现；Sentry 追踪有效
- 体验：地图/列表/图表联动无明显抖动；断网可访问关键页面；国际化完整

项目落地要点与踩坑清单
- MSW v2：使用 http + HttpResponse；浏览器端从 msw/browser 导入 setupWorker；类型用 import type
- Axios 实例：baseURL 统一成 /api；请求拦截带 token；响应拦截统一错误模型
- 地图图标：Vite 环境需显式引入 marker-icon/2x/shadow 并 mergeOptions
- 大数据点位：优先聚合而非海量单点；按层管理；避免频繁 setState 触发重绘
- PWA 缓存：瓦片与接口分策略；注意 OSM 版权与缓存范围；更新提示处理 SW 生命周期
- Sentry：分环境 DSN、采样率控制；上传 Source Map；隐私与脱敏
- E2E：CI 下无头浏览器；为地图容器设置稳定尺寸，避免快照漂移

展示物清单（务必准备）
- 在线 Demo 链接（主线 Web + 可选 UniApp H5）
- Docker 镜像与启动命令
- 仓库 README（特性亮点、架构图、运行/测试/部署、截图 5–8 张）
- 1–2 分钟演示视频（脚本：登录→筛选→圈选→聚合放大→图表联动→离线访问→错误追踪）
- 简历“项目亮点”与“技术关键词”（南京向）

南京向关键词（投递与面试）
- Vue3/TS、Leaflet/Mapbox、ECharts、Pinia、Vue Router（守卫/RBAC）
- MSW/Vitest/Playwright、Sentry、Docker、GitHub Actions、PWA
- 场景词：智慧城市/园区/IoT/运维可视化、空间筛选、聚合、路径规划、实时推送、离线

建议时间表（精简版）
- D1–D3：工程基线 + 鉴权 + MapView + MSW
- D4–D7：设施模块 + 联动 + 圈选 + 图表
- D8–D10：聚合 + 性能 + PWA + Sentry + i18n
- D11–D12：测试（unit/E2E）+ CI/CD
- D13–D14：Docker 化 + 部署 + README + 演示视频
- D15–D21（可选）：UniApp 巡检端 + 演示视频

附：启动与验证清单
- 本地
  - npm run dev：开发
  - npm run type-check、npm run lint、npm run test、npm run test:e2e
  - npm run build；docker build -t webgis-admin .
- CI：PR 自动执行 lint/type/test/build/docker，并产出镜像工件
- 监控：Sentry 面板可见错误与 Source Map 还原

结语
- 主线 Web 项目覆盖南京主流需求；副线 UniApp 为岗位加分项。
- 以“可演示/可部署/可维护”为目标，确保每周产出可见成果与可复现环境。